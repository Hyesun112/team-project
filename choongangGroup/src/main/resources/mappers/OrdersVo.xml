<?xml version="1.0" encoding="UTF-8"?>

<!-- ======= mapper 기본설정 ======= -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체 내에서 유일해야 한다.) ==== -->
<mapper namespace="com.oracle.choongangGroup.ry.model.OrdersVoMapper">
	<insert id="OrderInfo" parameterType="OrdersVo">
 	insert into Orders(orderId,orderName, userId, Phone, amount)
     values(#{orderId},#{orderName}, #{userId},#{Phone}, #{amount})
	</insert>
	
	<select id="OrderList" resultType="OrdersVo">
	 select
	     orderId, userId, orderName, Phone, amount, orderDate, state
	 from Orders 
	     where userId = #{userId}
	</select>
	
	<!-- 특정 주문 목록 -->
	<select id="OrderView" resultType="OrdersVo">
	 select
	     o.orderId, o.userId, o.orderName, o.Phone, o.amount, o.orderDate,o.state,
	     d.orderDetailsNum, d.bookId, d.cartStock,
	     g.bookName, g.bookThumbImg, g.bookPrice
	 from Orders o
	         inner join orderDetail d
	             on o.orderId = d.orderId
	         inner join book g
	             on d.bookId = g.bookId
	     where o.userId = #{userId}
	         and o.orderId = #{orderId}
	</select>
	<select id="AdminOrderList" resultType="OrdersVo">
	 select
	     *
	 from Orders 
<!-- 	     where orderId = #{orderId}-->	
	</select>
	
	<!-- 특정 주문 목록 -->
	<select id="AdminOrderView" resultType="OrdersVo">
	 select
	     o.orderId, o.userId, o.orderName, o.Phone, o.amount, o.orderDate,o.state,
	     d.orderDetailsNum, d.bookId, d.cartStock,
	     g.bookName, g.bookThumbImg, g.bookPrice
	 from Orders o
	         inner join orderDetail d
	             on o.orderId = d.orderId
	         inner join book g
	             on d.bookId = g.bookId
	     where o.orderId = #{orderId}
	</select>
	
	<!-- 배송 상태 -->
	<update id="UpdateState" parameterType="OrdersVo">
	 update Orders
	     set state = #{state}
	 where orderId = #{orderId}
	</update>
</mapper>